<!DOCTYPE html>
<html lang="en"><head>
<script src="lin-discr-slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="lin-discr-slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="lin-discr-slides_files/libs/quarto-html/popper.min.js"></script>
<script src="lin-discr-slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lin-discr-slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lin-discr-slides_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lin-discr-slides_files/libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="EDA for Machine Learning">
  <title>Linear Discriminant Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lin-discr-slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lin-discr-slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="lin-discr-slides_files/libs/revealjs/dist/theme/quarto-0144685976e4030202a49018b3418199.css">
  <link href="lin-discr-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lin-discr-slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lin-discr-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lin-discr-slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Linear Discriminant Analysis</h1>
  <p class="subtitle">Finding Directions of Maximum Class Separation</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
EDA for Machine Learning 
</div>
</div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Chapter 9</h2>
<ul>
<li><a href="#/what-is-lda" id="/toc-what-is-lda">What is LDA?</a></li>
<li><a href="#/fishers-geometric-view" id="/toc-fishers-geometric-view">Fisher’s Geometric View</a></li>
<li><a href="#/why-linear-boundaries" id="/toc-why-linear-boundaries">Why Linear Boundaries?</a></li>
<li><a href="#/lda-vs-qda" id="/toc-lda-vs-qda">LDA vs QDA</a></li>
<li><a href="#/example-wine-color" id="/toc-example-wine-color">Example: Wine Color</a></li>
<li><a href="#/example-wine-quality" id="/toc-example-wine-quality">Example: Wine Quality</a></li>
<li><a href="#/summary" id="/toc-summary">Summary</a></li>
<li><a href="#/exercises" id="/toc-exercises">Exercises</a></li>
<li><a href="#/resources" id="/toc-resources">Resources</a></li>
</ul>
</nav>
</section>
<section>
<section id="what-is-lda" class="title-slide slide level1 center">
<h1>What is LDA?</h1>

</section>
<section id="the-core-question" class="slide level2">
<h2>The Core Question</h2>
<p>In Chapter 8, PCA asked: “Along which directions do features vary most?”</p>
<div class="fragment">
<p>Now we ask a different question:</p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Core Question</strong></p>
</div>
<div class="callout-content">
<p>Along which directions are the <strong>classes</strong> best separated?</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>When class labels are available, we can do better than maximizing variance.</p>
</div>
</section>
<section id="pca-vs-lda-the-key-distinction" class="slide level2">
<h2>PCA vs LDA: The Key Distinction</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>PCA</th>
<th>LDA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Input</strong></td>
<td>Features only</td>
<td>Features + class labels</td>
</tr>
<tr class="even">
<td><strong>Objective</strong></td>
<td>Maximize variance</td>
<td>Maximize class separation</td>
</tr>
<tr class="odd">
<td><strong>Type</strong></td>
<td>Unsupervised</td>
<td>Supervised</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>Both find directions for projection—but “best” means different things.</p>
</div>
</section>
<section id="when-pca-fails" class="slide level2">
<h2>When PCA Fails</h2>

<img data-src="lin-discr-slides_files/figure-revealjs/pca-fails-example-1.png" width="768" class="r-stretch quarto-figure-center"><p class="caption">When projected to PC1, the two classes completely overlap</p><div class="fragment">
<p><strong>PC1</strong> (dashed): Maximum variance—but useless for classification!</p>
<p><strong>LD1</strong> (solid): Maximum class separation—the direction we need.</p>
</div>
</section>
<section id="the-lda-solution" class="slide level2">
<h2>The LDA Solution</h2>
<p>LDA finds the direction(s) that:</p>
<div class="fragment">
<ol type="1">
<li><strong>Maximize</strong> the spread of class means (between-class variance)</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Minimize</strong> the spread within each class (within-class variance)</li>
</ol>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>LDA in One Sentence</strong></p>
</div>
<div class="callout-content">
<p>Maximize separation between classes while keeping each class tight.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="fishers-geometric-view" class="title-slide slide level1 center">
<h1>Fisher’s Geometric View</h1>

</section>
<section id="two-types-of-variance" class="slide level2">
<h2>Two Types of Variance</h2>
<p>When we project data onto a direction <span class="math inline">\(a\)</span>, we can measure:</p>
<div class="fragment">
<p><strong>Between-class variance</strong>: How spread out are the projected class means?</p>
</div>
<div class="fragment">
<p><strong>Within-class variance</strong>: How spread out are observations around their class mean?</p>
</div>
<div class="fragment">
<p>Good classification directions have <strong>high between-class</strong> and <strong>low within-class</strong> variance.</p>
</div>
</section>
<section id="visual-within-vs-between" class="slide level2">
<h2>Visual: Within vs Between</h2>

<img data-src="lin-discr-slides_files/figure-revealjs/fig-within-between-1.png" width="768" class="r-stretch quarto-figure-center" id="fig-within-between"><p class="caption">
Figure&nbsp;1: Within-class spread (ellipses) vs between-class spread (line connecting means)
</p></section>
<section id="fishers-criterion" class="slide level2">
<h2>Fisher’s Criterion</h2>
<p>R.A. Fisher (1936) proposed: find direction <span class="math inline">\(a\)</span> that maximizes the ratio</p>
<p><span class="math display">\[
\frac{\text{Between-class variance}}{\text{Within-class variance}} = \frac{a^\top B \, a}{a^\top W \, a}
\]</span></p>
<div class="fragment">
<p>where:</p>
<ul>
<li><span class="math inline">\(B\)</span> = between-class covariance matrix</li>
<li><span class="math inline">\(W\)</span> = within-class (pooled) covariance matrix</li>
</ul>
</div>
<div class="fragment">
<p>This <strong>Rayleigh quotient</strong> balances separation against spread.</p>
</div>
</section>
<section id="the-eigenvalue-solution" class="slide level2">
<h2>The Eigenvalue Solution</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Key Result</strong></p>
</div>
<div class="callout-content">
<p>The optimal direction <span class="math inline">\(a\)</span> is the eigenvector of <span class="math inline">\(W^{-1}B\)</span> with the largest eigenvalue.</p>
</div>
</div>
</div>
<div class="fragment">
<p><span class="math display">\[
W^{-1} B \, a = \lambda \, a
\]</span></p>
</div>
<div class="fragment">
<p>Like PCA, LDA reduces to an eigenvalue problem—we solve directly, no iteration.</p>
</div>
</section>
<section id="how-many-directions" class="slide level2">
<h2>How Many Directions?</h2>
<p>With <span class="math inline">\(K\)</span> classes, the matrix <span class="math inline">\(B\)</span> has rank at most <span class="math inline">\(K - 1\)</span>.</p>
<div class="fragment">
<p><strong>Why?</strong> The <span class="math inline">\(K\)</span> class means live in an affine subspace of dimension <span class="math inline">\(K - 1\)</span>.</p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Dimension Reduction</strong></p>
</div>
<div class="callout-content">
<p>LDA produces at most <span class="math inline">\(\min(d, K-1)\)</span> discriminant directions.</p>
<ul>
<li><span class="math inline">\(K = 2\)</span> classes → <strong>1 direction</strong> (LD1)</li>
<li><span class="math inline">\(K = 3\)</span> classes → <strong>2 directions</strong> (LD1, LD2)</li>
</ul>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Regardless of how many features <span class="math inline">\(d\)</span> you start with!</p>
</div>
</section>
<section id="connection-to-pca" class="slide level2">
<h2>Connection to PCA</h2>
<p>Both PCA and LDA find optimal projection directions:</p>
<table class="caption-top">
<colgroup>
<col style="width: 23%">
<col style="width: 38%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>PCA</th>
<th>LDA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Maximizes</strong></td>
<td><span class="math inline">\(\dfrac{a^\top T \, a}{a^\top I \, a}\)</span></td>
<td><span class="math inline">\(\dfrac{a^\top B \, a}{a^\top W \, a}\)</span></td>
</tr>
<tr class="even">
<td><strong>Matrix</strong></td>
<td>Total covariance <span class="math inline">\(T\)</span></td>
<td>Between/Within ratio</td>
</tr>
<tr class="odd">
<td><strong>Constraint</strong></td>
<td>Unit length</td>
<td>Unit length (in <span class="math inline">\(W\)</span> metric)</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p><strong>Key insight</strong>: LDA is like PCA, but measuring spread relative to within-class variation rather than identity.</p>
</div>
</section></section>
<section>
<section id="why-linear-boundaries" class="title-slide slide level1 center">
<h1>Why Linear Boundaries?</h1>

</section>
<section id="the-gaussian-assumption" class="slide level2">
<h2>The Gaussian Assumption</h2>
<p>LDA assumes each class has a multivariate normal distribution:</p>
<p><span class="math display">\[
f_k(x) = \frac{1}{(2\pi)^{d/2} |\Sigma|^{1/2}} \exp\left( -\frac{1}{2} (x - \mu_k)^\top \Sigma^{-1} (x - \mu_k) \right)
\]</span></p>
<div class="fragment">
<p><strong>Key assumption</strong>: All classes share the <strong>same covariance</strong> <span class="math inline">\(\Sigma\)</span>.</p>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(\Sigma\)</span>: covariance matrix common to all classes</li>
<li><span class="math inline">\(\mu_k\)</span>: distinct mean values</li>
<li><span class="math inline">\(\pi_k\)</span>: prior probabilities of class occurrence</li>
</ul>
</div>
</section>
<section id="from-bayes-rule-to-linear-boundaries" class="slide level2">
<h2>From Bayes Rule to Linear Boundaries</h2>
<p>The optimal classifier assigns <span class="math inline">\(x\)</span> to the class with highest posterior probability.</p>
<div class="fragment">
<p>Under Gaussian assumptions with common covariance, this simplifies to:</p>
<p><span class="math display">\[
\delta_k(x) = x^\top \Sigma^{-1} \mu_k - \frac{1}{2} \mu_k^\top \Sigma^{-1} \mu_k + \log(\pi_k)
\]</span></p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Discriminant Function</strong></p>
</div>
<div class="callout-content">
<p><span class="math inline">\(\delta_k(x)\)</span> is <strong>linear in <span class="math inline">\(x\)</span></strong>—it tells you how much class <span class="math inline">\(k\)</span> “likes” observation <span class="math inline">\(x\)</span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="decision-boundaries" class="slide level2">
<h2>Decision Boundaries</h2>
<p>Classify to class <span class="math inline">\(k\)</span> if <span class="math inline">\(\delta_k(x) &gt; \delta_j(x)\)</span> for all <span class="math inline">\(j \neq k\)</span>.</p>
<div class="fragment">
<p>The boundary between classes <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span> is where <span class="math inline">\(\delta_j(x) = \delta_k(x)\)</span>.</p>
</div>
<div class="fragment">
<p>Since both are linear in <span class="math inline">\(x\)</span>, the boundary is a <strong>hyperplane</strong>:</p>
<ul>
<li>In 2D: a line</li>
<li>In 3D: a plane</li>
<li>In <span class="math inline">\(d\)</span> dimensions: a <span class="math inline">\((d-1)\)</span>-dimensional hyperplane</li>
</ul>
</div>
</section>
<section id="two-routes-same-destination" class="slide level2">
<h2>Two Routes, Same Destination</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Equivalence</strong></p>
</div>
<div class="callout-content">
<p>Fisher’s geometric criterion and the Bayesian/Gaussian derivation yield <strong>exactly the same</strong> discriminant directions—when class covariances are equal.</p>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Fisher</strong>: No distributional assumptions, purely geometric</p>
<p><strong>Bayes</strong>: Provides posterior probabilities, principled classification rule</p>
</div>
<div class="fragment">
<p>Use whichever perspective helps your intuition!</p>
</div>
</section></section>
<section>
<section id="lda-vs-qda" class="title-slide slide level1 center">
<h1>LDA vs QDA</h1>

</section>
<section id="what-if-covariances-differ" class="slide level2">
<h2>What If Covariances Differ?</h2>
<p>LDA assumes all classes share the same covariance matrix.</p>
<div class="fragment">
<p><strong>Quadratic Discriminant Analysis (QDA)</strong> relaxes this:</p>
<ul>
<li>Each class <span class="math inline">\(k\)</span> has its own covariance <span class="math inline">\(\Sigma_k\)</span></li>
<li>Decision boundaries become <strong>quadratic</strong> (curved)</li>
</ul>
</div>
</section>
<section id="visual-comparison" class="slide level2">
<h2>Visual Comparison</h2>

<img data-src="lin-discr-slides_files/figure-revealjs/fig-lda-vs-qda-1.png" width="768" class="r-stretch quarto-figure-center" id="fig-lda-vs-qda"><p class="caption">
Figure&nbsp;2: LDA (linear boundary) vs QDA (curved boundary)
</p></section>
<section id="lda-vs-qda-trade-offs" class="slide level2">
<h2>LDA vs QDA: Trade-offs</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>LDA</th>
<th>QDA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Assumption</strong></td>
<td>Common covariance</td>
<td>Class-specific covariances</td>
</tr>
<tr class="even">
<td><strong>Boundary</strong></td>
<td>Linear (hyperplane)</td>
<td>Quadratic (curved)</td>
</tr>
<tr class="odd">
<td><strong>Parameters</strong></td>
<td>Fewer</td>
<td>More</td>
</tr>
<tr class="even">
<td><strong>Bias</strong></td>
<td>Higher if assumption violated</td>
<td>Lower</td>
</tr>
<tr class="odd">
<td><strong>Variance</strong></td>
<td>Lower</td>
<td>Higher</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p><strong>Rule of thumb</strong>: Use LDA unless you have strong evidence of unequal covariances <em>and</em> enough data to estimate them reliably.</p>
</div>
</section></section>
<section>
<section id="example-wine-color" class="title-slide slide level1 center">
<h1>Example: Wine Color</h1>

</section>
<section id="the-wine-quality-data" class="slide level2">
<h2>The Wine Quality Data</h2>
<p>In Chapter 8, PCA discovered that wine color was the dominant source of variation—<em>without using color labels</em>.</p>
<div class="fragment">
<p>Now we ask: <strong>given</strong> that we want to classify red vs white, what direction achieves the best separation?</p>
</div>
<div class="fragment">
<p>This is the LDA question.</p>
</div>
</section>
<section id="two-features-density-and-residual-sugar" class="slide level2">
<h2>Two Features: Density and Residual Sugar</h2>

<img data-src="lin-discr-slides_files/figure-revealjs/fig-wine-2d-lda-1.png" width="768" class="r-stretch quarto-figure-center" id="fig-wine-2d-lda"><p class="caption">
Figure&nbsp;3: Wine color: LDA decision boundary with two features
</p></section>
<section id="two-feature-lda-coefficients" class="slide level2">
<h2>Two-Feature LDA: Coefficients</h2>
<div class="cell">
<div id="tbl-wine-2d-coefficients" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-wine-2d-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1
</figcaption>
<div aria-describedby="tbl-wine-2d-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Feature</th>
<th style="text-align: right;">LD1 Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">density</td>
<td style="text-align: right;">-1.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">res_sugar</td>
<td style="text-align: right;">1.67</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="fragment">
<p><strong>Interpretation</strong>: Wines with lower density and higher residual sugar → white</p>
<p>Wines with higher density and lower residual sugar → red</p>
</div>
</section>
<section id="two-feature-performance" class="slide level2">
<h2>Two-Feature Performance</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<caption>Confusion matrix: 2 features</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">red</th>
<th style="text-align: right;">white</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">red</td>
<td style="text-align: right;">1403</td>
<td style="text-align: right;">151</td>
</tr>
<tr class="even">
<td style="text-align: left;">white</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">4747</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="fragment">
<p>With just 2 features: ~88% accuracy on red, ~97% on white.</p>
<p>Can we do better with more features?</p>
</div>
</section>
<section id="all-eleven-features" class="slide level2">
<h2>All Eleven Features</h2>
<div class="cell">
<div id="tbl-wine-full-coefficients" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wine-full-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: LD1 coefficients for all 11 features
</figcaption>
<div aria-describedby="tbl-wine-full-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Feature</th>
<th style="text-align: right;">LD1 Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">density</td>
<td style="text-align: right;">-2.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">res_sugar</td>
<td style="text-align: right;">1.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_so2</td>
<td style="text-align: right;">1.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">alcohol</td>
<td style="text-align: right;">-0.98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vol_acidity</td>
<td style="text-align: right;">-0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">fix_acidity</td>
<td style="text-align: right;">0.42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">free_so2</td>
<td style="text-align: right;">-0.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">chlorides</td>
<td style="text-align: right;">-0.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pH</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">sulphates</td>
<td style="text-align: right;">-0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">citric_acid</td>
<td style="text-align: right;">0.13</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="eleven-feature-performance" class="slide level2">
<h2>Eleven-Feature Performance</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<caption>Confusion matrix: 11 features</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">red</th>
<th style="text-align: right;">white</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">red</td>
<td style="text-align: right;">1580</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">white</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">4882</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="fragment">
<p>Misclassification drops to ~1.2% for red and ~0.3% for white.</p>
</div>
</section>
<section id="ld1-score-distribution" class="slide level2">
<h2>LD1 Score Distribution</h2>

<img data-src="lin-discr-slides_files/figure-revealjs/fig-wine-ld1-hist-1.png" width="768" class="r-stretch quarto-figure-center" id="fig-wine-ld1-hist"><p class="caption">
Figure&nbsp;4: Distribution of LD1 scores by wine color
</p><div class="fragment">
<p>The decision boundary (dashed line) falls between the two distributions.</p>
</div>
</section>
<section id="lda-vs-pca-same-answer" class="slide level2">
<h2>LDA vs PCA: Same Answer?</h2>
<p>In Chapter 8, PCA found that PC1 separated wine colors.</p>
<div class="fragment">
<p>Here, LDA’s LD1 also separates wine colors.</p>
</div>
<div class="fragment">
<p><strong>Are they the same direction?</strong></p>
</div>
<div class="fragment">
<p>In this case, nearly so—because the classes differ primarily along directions of high variance.</p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>When They Differ</strong></p>
</div>
<div class="callout-content">
<p>If classes differed along a direction of <em>low</em> variance, PCA would miss it while LDA would find it.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="example-wine-quality" class="title-slide slide level1 center">
<h1>Example: Wine Quality</h1>

</section>
<section id="a-harder-problem-k-3" class="slide level2">
<h2>A Harder Problem <span class="math inline">\((K = 3)\)</span></h2>
<p>Now classify wines by quality level (low/medium/high) instead of color.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Quality Level</th>
<th style="text-align: right;">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">low</td>
<td style="text-align: right;">2384</td>
</tr>
<tr class="even">
<td style="text-align: left;">medium</td>
<td style="text-align: right;">2836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high</td>
<td style="text-align: right;">1277</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="fragment">
<p><strong>Note</strong>: Classes are imbalanced—most wines are “medium” quality.</p>
</div>
</section>
<section id="three-classes-two-directions" class="slide level2">
<h2>Three Classes → Two Directions</h2>
<p>With <span class="math inline">\(K = 3\)</span> classes, LDA produces at most <span class="math inline">\(K - 1 = 2\)</span> directions.</p>

<img data-src="lin-discr-slides_files/figure-revealjs/fig-wine-quality-ld-1.png" width="768" class="r-stretch quarto-figure-center" id="fig-wine-quality-ld"><p class="caption">
Figure&nbsp;5: White wines projected onto LD1 and LD2 (3 quality levels)
</p></section>
<section id="quality-classification-results" class="slide level2">
<h2>Quality Classification: Results</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<caption>Confusion matrix: wine quality (white wines)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">low</th>
<th style="text-align: right;">medium</th>
<th style="text-align: right;">high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">low</td>
<td style="text-align: right;">939</td>
<td style="text-align: right;">504</td>
<td style="text-align: right;">77</td>
</tr>
<tr class="even">
<td style="text-align: left;">medium</td>
<td style="text-align: right;">666</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">603</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">304</td>
<td style="text-align: right;">380</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="fragment">
<p>Most wines are classified as “medium”—the classifier struggles to separate quality levels.</p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Reality Check</strong></p>
</div>
<div class="callout-content">
<p>LDA can’t work miracles. Predicting quality from chemistry alone is genuinely hard—winemaking involves factors not captured in these measurements.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="summary" class="title-slide slide level1 center">
<h1>Summary</h1>

</section>
<section id="key-takeaways" class="slide level2">
<h2>Key Takeaways</h2>
<ol type="1">
<li><strong>LDA finds directions of maximum class separation</strong>—not just maximum variance</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Fisher’s criterion</strong>: Maximize between-class variance relative to within-class variance</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><strong>Closed-form solution</strong> via eigenvalue decomposition—like PCA</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><strong>Dimension reduction</strong>: <span class="math inline">\(K\)</span> classes → at most <span class="math inline">\(K - 1\)</span> discriminant directions</li>
</ol>
</div>
<div class="fragment">
<ol start="5" type="1">
<li><strong>Linear boundaries</strong> arise from equal covariance assumption; <strong>QDA</strong> relaxes this</li>
</ol>
</div>
</section>
<section id="key-formulas" class="slide level2">
<h2>Key Formulas</h2>
<p><strong>Fisher’s criterion:</strong> <span class="math display">\[\max_a \; \frac{a^\top B \, a}{a^\top W \, a}\]</span></p>
<div class="fragment">
<p><strong>Eigenvalue problem:</strong> <span class="math display">\[W^{-1} B \, a = \lambda \, a\]</span></p>
</div>
<div class="fragment">
<p><strong>Discriminant function:</strong> <span class="math display">\[\delta_k(x) = x^\top \Sigma^{-1} \mu_k - \frac{1}{2} \mu_k^\top \Sigma^{-1} \mu_k + \log(\pi_k)\]</span></p>
</div>
<div class="fragment">
<p><strong>Classification rule:</strong> Assign <span class="math inline">\(x\)</span> to class <span class="math inline">\(k\)</span> with largest <span class="math inline">\(\delta_k(x)\)</span></p>
</div>
</section>
<section id="connections-to-part-2" class="slide level2">
<h2>Connections to Part 2</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Chapter</th>
<th>Subspace Basis</th>
<th>Determined by</th>
<th>Used for</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7: Regression</td>
<td><span class="math inline">\(\text{col}(X)\)</span></td>
<td>Model specification</td>
<td>Prediction</td>
</tr>
<tr class="even">
<td>8: PCA</td>
<td>Principal components</td>
<td>Data covariance</td>
<td>Exploration</td>
</tr>
<tr class="odd">
<td>9: LDA</td>
<td>Discriminant directions</td>
<td>Class labels</td>
<td>Classification</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>All three use <strong>orthogonal projection</strong>—they differ in how the target subspace is determined and used.</p>
</div>
</section>
<section id="looking-ahead" class="slide level2">
<h2>Looking Ahead</h2>
<p><strong>Part III: Text Data</strong></p>
<ul>
<li>A new kind of high-dimensional data: term-document matrices</li>
<li>Topic models for discovering thematic structure</li>
<li><em>Latent Dirichlet Allocation</em>—the other LDA!</li>
</ul>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The Name Collision</strong></p>
</div>
<div class="callout-content">
<p>“LDA” means Linear Discriminant Analysis here, but Latent Dirichlet Allocation in text analysis. Context makes clear which is intended.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="exercises" class="title-slide slide level1 center">
<h1>Exercises</h1>

</section>
<section id="team-exercise-1-fishers-criterion" class="slide level2">
<h2>Team Exercise 1: Fisher’s Criterion</h2>
<p>For a two-class problem in 2D:</p>
<ol type="1">
<li>Explain in words what the within-class covariance matrix <span class="math inline">\(W\)</span> measures.</li>
<li>Explain in words what the between-class covariance matrix <span class="math inline">\(B\)</span> measures.</li>
<li>Why does maximizing <span class="math inline">\(a^\top B a / a^\top W a\)</span> yield a good classification direction?</li>
<li>For <span class="math inline">\(K = 2\)</span> classes, <span class="math inline">\(B\)</span> has rank 1. Why?</li>
</ol>
</section>
<section id="team-exercise-2-when-pca-fails" class="slide level2">
<h2>Team Exercise 2: When PCA Fails</h2>
<p>Construct a 2D example where PC1 is perpendicular to LD1:</p>
<ol type="1">
<li>Sketch two classes whose means differ along the x-axis, but with much larger variance along the y-axis.</li>
<li>What direction will PCA find? What direction will LDA find?</li>
<li>What does this illustrate about supervised vs unsupervised dimension reduction?</li>
</ol>
</section>
<section id="team-exercise-3-lda-vs-logistic-regression" class="slide level2">
<h2>Team Exercise 3: LDA vs Logistic Regression</h2>
<p>Both LDA and logistic regression produce linear decision boundaries.</p>
<ol type="1">
<li>What distributional assumptions does LDA make? What about logistic regression?</li>
<li>When would you prefer LDA? When logistic regression?</li>
<li>Fit both to the wine color data and compare decision boundaries.</li>
</ol>
</section>
<section id="team-exercise-4-qda" class="slide level2">
<h2>Team Exercise 4: QDA</h2>
<p>Using the wine data:</p>
<ol type="1">
<li>Compute the covariance matrix of features separately for red and white wines.</li>
<li>Are they similar? How would you test this?</li>
<li>Fit QDA and compare its decision boundary to LDA.</li>
<li>Does QDA improve classification accuracy?</li>
</ol>
</section></section>
<section>
<section id="resources" class="title-slide slide level1 center">
<h1>Resources</h1>

</section>
<section id="references" class="slide level2">
<h2>References</h2>
<ul>
<li><p><a href="https://www.statlearning.com/">An Introduction to Statistical Learning (ISLR2)</a></p>
<ul>
<li>Chapter 4 covers LDA</li>
</ul></li>
<li><p><a href="https://hastie.su.domains/ElemStatLearn/">The Elements of Statistical Learning</a></p>
<ul>
<li>Chapter 4 for advanced treatment</li>
</ul></li>
<li><p><a href="https://stat.ethz.ch/R-manual/R-devel/library/MASS/html/lda.html">MASS::lda() documentation</a></p>
<ul>
<li>R’s classic LDA implementation</li>
</ul></li>
<li><p><a href="https://discrim.tidymodels.org/">discrim package</a></p>
<ul>
<li>tidymodels interface to discriminant analysis</li>
</ul></li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lin-discr-slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lin-discr-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lin-discr-slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lin-discr-slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>